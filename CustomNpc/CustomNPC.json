[
  {
    "id": "update_stat",
    "type": "effect_on_condition"
  },
  {
    "id": "CustomNPC_if0",
    "type": "effect_on_condition",
    "effect": [
      {"math":["u_currhp","=","u_hp()"]}
    ],
    "condition": {"math":["u_currhp","==","0"]}
  },
  {
    "id": "CNPC_EOC_InitCurrHP",
    "type": "effect_on_condition",
    "effect": [
      {"run_eocs":"CustomNPC_if0"}
    ],
    "eoc_type": "ACTIVATION"
  },
  {
    "id": "CNPC_EOC_UpdateInitCurrHP",
    "type": "effect_on_condition",
    "effect": [
      {"u_cast_spell":{"id":"CNPC_SPELL_InitCurrHP"}}
    ],
    "recurrence": 1
  },
  {
    "id": "CustomNPC_if1",
    "type": "effect_on_condition",
    "effect": [
      {"u_cast_spell":{"id":"CNPC_SPELL_SummonTarget"}},
      {"math":["has_target","=","1"]}
    ],
    "condition": {"and":[{"math":["u_currhp",">","u_hp()"]},{"math":["has_target","==","0"]}]}
  },
  {
    "id": "CNPC_EOC_CheckCurrHP",
    "type": "effect_on_condition",
    "effect": [
      {"math":["mag1","=","u_currhp"]},
      {"math":["mag2","=","u_hp()"]},
      {"run_eocs":"CustomNPC_if1"},
      {"math":["u_currhp","=","u_hp()"]}
    ],
    "eoc_type": "ACTIVATION"
  },
  {
    "id": "CNPC_EOC_HitEocs",
    "type": "effect_on_condition",
    "effect": [
      {"u_cast_spell":{"id":"CNPC_SPELL_CheckCurrHP"}},
      {"math":["has_target","=","0"]},
      {"u_cast_spell":{"id":"CNPC_SPELL_TestConeSpell"},"targeted":true}
    ],
    "eoc_type": "ACTIVATION"
  },
  {
    "id": "CNPC_EOC_SpawnBaseNpc",
    "type": "effect_on_condition",
    "effect": [
      {"u_spawn_npc":"CNPC_NPC_BaseNpc","real_count":1,"min_radius":1,"max_radius":1,"spawn_message":"生成了一个基础NPC"}
    ]
  },
  {
    "id": "CustomNPC",
    "type": "effect_on_condition"
  }
]